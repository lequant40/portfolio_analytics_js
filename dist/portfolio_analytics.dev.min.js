/*! portfolio-analytics - v0.0.4 (2017-05-25), Roman Rubsamen <roman.rubsamen@gmail.com> */var PortfolioAnalytics=PortfolioAnalytics||{};PortfolioAnalytics=function(a){function b(a,b,c){for(var d=-(1/0),e=-(1/0),f=-1,g=-1,h=-1,i=b;i<c+1;++i){a[i]>d&&(d=a[i],f=i);var j=(d-a[i])/d;j>e&&(e=j,g=f,h=i)}return[e,g,h]}function c(a,b){var c=d(a,b),e=w(c),f=e[0],g=e[2],h=e[3],i=e[4],j=f/g,k=(1+.25*j*j*(i-1)-j*h)/(c.length-1),l=1+.25*(i-1)/c.length;return[j,k,l]}function d(b,c){for(var d=a.arithmeticReturns(b).slice(1),e=a.arithmeticReturns(c).slice(1),f=new d.constructor(d.length),g=0;g<d.length;++g)f[g]=d[g]-e[g];return f}function e(a,b){void 0===b&&(b=!1);var c=[-39.69683028665376,220.9460984245205,-275.9285104469687,138.357751867269,-30.66479806614716,2.506628277459239],d=[-54.47609879822406,161.5858368580409,-155.6989798598866,66.80131188771972,-13.28068155288572],e=[-.007784894002430293,-.3223964580411365,-2.400758277161838,-2.549732539343734,4.374664141464968,2.938163982698783],f=[.007784695709041462,.3224671290700398,2.445134137142996,3.754408661907416],g=.02425,i=1-g,j=NaN;if(0==a)j=Number.NEGATIVE_INFINITY;else if(1==a)j=Number.POSITIVE_INFINITY;else if(a<g){var k=Math.sqrt(-2*Math.log(a));j=(((((e[0]*k+e[1])*k+e[2])*k+e[3])*k+e[4])*k+e[5])/((((f[0]*k+f[1])*k+f[2])*k+f[3])*k+1)}else if(a>i){var k=Math.sqrt(-2*Math.log(1-a));j=-(((((e[0]*k+e[1])*k+e[2])*k+e[3])*k+e[4])*k+e[5])/((((f[0]*k+f[1])*k+f[2])*k+f[3])*k+1)}else if(g<=a&&a<=i){var k=a-.5,l=k*k;j=(((((c[0]*l+c[1])*l+c[2])*l+c[3])*l+c[4])*l+c[5])*k/(((((d[0]*l+d[1])*l+d[2])*l+d[3])*l+d[4])*l+1)}if(b===!0){var m=.5*h(-j/1.4142135623730951)-a,n=2.5066282746310002*m*Math.exp(j*j/2);j-=n/(1+j*n/2)}return j}function f(a){for(var b=a,c=0,d=a,e=a*a,f=1;b!=c;)b=(c=b)+(d*=e/(f+=2));return.5+b*Math.exp(-.5*e-.9189385332046728)}function g(a){return i(a,0)}function h(a){return i(a,1)}function i(a,b){var c=1.11e-16,d=26.543,e=[3.1611237438705655,113.86415415105016,377.485237685302,3209.3775891384694,.18577770618460315],f=[23.601290952344122,244.02463793444417,1282.6165260773723,2844.236833439171],g=[.5641884969886701,8.883149794388377,66.11919063714163,298.6351381974001,881.952221241769,1712.0476126340707,2051.0783778260716,1230.3393547979972,2.1531153547440383e-8],h=[15.744926110709835,117.6939508913125,537.1811018620099,1621.3895745666903,3290.7992357334597,4362.619090143247,3439.3676741437216,1230.3393548037495],i=[.30532663496123236,.36034489994980445,.12578172611122926,.016083785148742275,.0006587491615298378,.016315387137302097],j=[2.568520192289822,1.8729528499234604,.5279051029514285,.06051834131244132,.0023352049762686918],k=Math.abs(a);if(k<=.46875){var l=0;k>=c&&(l=k*k);var m=a*((((e[4]*l+e[0])*l+e[1])*l+e[2])*l+e[3])/((((l+f[0])*l+f[1])*l+f[2])*l+f[3]);return 1===b&&(m=1-m),m}if(k<=4){var m=((((((((g[8]*k+g[0])*k+g[1])*k+g[2])*k+g[3])*k+g[4])*k+g[5])*k+g[6])*k+g[7])/((((((((k+h[0])*k+h[1])*k+h[2])*k+h[3])*k+h[4])*k+h[5])*k+h[6])*k+h[7]),l=16*k;l=(l>=0?Math.floor(l):Math.ceil(l))/16;var n=(k-l)*(k+l);m=Math.exp(-l*l)*Math.exp(-n)*m}else if(k>4){var m=0;if(k<d){var l=1/(k*k);m=l*(((((i[5]*l+i[0])*l+i[1])*l+i[2])*l+i[3])*l+i[4])/(((((l+j[0])*l+j[1])*l+j[2])*l+j[3])*l+j[4]),m=(.5641895835477563-m)/k;var l=16*k;l=(l>=0?Math.floor(l):Math.ceil(l))/16;var n=(k-l)*(k+l);m=Math.exp(-l*l)*Math.exp(-n)*m}}return 0===b?(m=.5-m+.5,a<=0&&(m=-m)):1===b&&a<=0&&(m=2-m),m}function j(a,b,c){for(var d=a.length,e=0,f=0,g=0;g<d;++g)f+=Math.pow(Math.max(0,a[g]-c),b);e=f/d;for(var h=0,g=0;g<d;++g)h+=Math.pow(Math.max(0,a[g]-c),b)-e;return(f+h)/d}function k(a,b,c){for(var d=a.length,e=0,f=0,g=0;g<d;++g)f+=Math.pow(Math.max(0,c-a[g]),b);e=f/d;for(var h=0,g=0;g<d;++g)h+=Math.pow(Math.max(0,c-a[g]),b)-e;return(f+h)/d}function l(a){for(var b=a.length,c=0,d=0,e=0;e<b;++e)d+=a[e];c=d/b;for(var f=0,e=0;e<b;++e)f+=a[e]-c;return(d+f)/b}function m(a){for(var b=a.length,c=l(a),d=0,e=0,f=0;f<b;++f){var g=a[f]-c;d+=g*g,e+=g}var h=d-e*e/b;return h/b}function n(a){var b=a.length;return m(a)*b/(b-1)}function o(a,b){for(var c=a.length,d=l(a),e=l(b),f=0,g=0,h=0,i=0;i<c;++i){var j=a[i]-d,k=b[i]-e;f+=j*k,g+=j,h+=k}var m=f-g*h/c;return m/c}function p(a,b){var c=a.length;return o(a,b)*c/(c-1)}function q(a){return Math.sqrt(m(a))}function r(a){return Math.sqrt(n(a))}function s(a){for(var b=a.length,c=l(a),d=0,e=0,f=0,g=0;g<b;++g){var h=a[g]-c,i=h*h;d+=h*i,e+=i,f+=h}var j=f*f,k=d-2*f*e/b+2*j*f/(b*b),m=(e-j/b)/b;return k/(b*Math.sqrt(m)*m)}function t(a){var b=a.length;return s(a)*Math.sqrt(b*(b-1))/(b-2)}function u(a){for(var b=a.length,c=l(a),d=0,e=0,f=0,g=0,h=0;h<b;++h){var i=a[h]-c,j=i*i;d+=j*j,e+=i*j,f+=j,g+=i}var k=b*b,m=g*g,n=d-4*g*e/b+6*m*f/k-3*m*m/(k*b),o=(f-m/b)/b;return n/(b*o*o)}function v(a){var b=a.length;return(b-1)/((b-2)*(b-3))*((b+1)*u(a)-3*(b-1))+3}function w(a){for(var b=a.length,c=l(a),d=0,e=0,f=0,g=0,h=0;h<b;++h){var i=a[h]-c,j=i*i;d+=j*j,e+=i*j,f+=j,g+=i}var k=g*g,m=b*b,n=f-g*g/b,o=e-2*g*f/b+2*k*g/(b*b),p=d-4*g*e/b+6*k*f/m-3*k*k/(m*b),q=NaN,r=NaN,s=NaN,t=NaN,u=n/b,q=u*b/(b-1),r=Math.sqrt(q),v=o/(b*Math.sqrt(u)*u),s=v*Math.sqrt(b*(b-1))/(b-2),w=p/(b*u*u),t=(b-1)/((b-2)*(b-3))*((b+1)*w-3*(b-1))+3;return[c,q,r,s,t]}return a.maxDrawdown_=function(a,c,d){return b(a,c,d)},a.maxDrawdown=function(a){var c=b(a,0,a.length-1);return c[0]==-(1/0)?0:c[0]},a.drawdownFunction=function(a){for(var b=-(1/0),c=new a.constructor(a.length),d=0;d<a.length;++d)a[d]>b&&(b=a[d]),c[d]=(b-a[d])/b;return c},a.topDrawdowns=function(a,c){if(0==c)return[];var d=[],e=[];for(e.push([0,a.length-1,c]);0!=e.length;){var f=e.pop(),g=f[0],h=f[1],i=f[2],j=b(a,g,h),k=j[1],l=j[2],m=j[0];0!=m&&m!=-(1/0)&&d.push([m,k,l]),1==i||k==g&&l==h||(k==g&&l<h?e.push([l,h,i-1]):k>g&&l==h?e.push([g,k,i-1]):(e.push([g,k,i-1]),e.push([l,h,i-1])))}return d.sort(function(a,b){var c=a[0],d=b[0];if(c<d)return 1;if(c>d)return-1;var e=a[1],f=b[1];return e<f?-1:1}),d.slice(0,Math.min(c,d.length))},a.ulcerIndex=function(b){for(var c=a.drawdownFunction(b),d=0,e=0;e<c.length;++e)d+=c[e]*c[e];return Math.sqrt(d/c.length)},a.painIndex=function(b){var c=a.drawdownFunction(b);return l(c)},a.conditionalDrawdown=function(b,c){var d=a.drawdownFunction(b).slice(1);if(d.sort(function(a,b){return a-b}),1==c)return d[d.length-1];for(var e=1;c>e/d.length;)++e;for(var f=d[e-1],g=e/d.length,h=(g-c)*f,i=0,j=e;j<d.length;++j)i+=d[j];i/=d.length;var k=(h+i)/(1-c);return k},a.gainToPainRatio=function(b){var c=a.arithmeticReturns(b).slice(1);if(0==c.length)return NaN;var d=l(c),e=k(c,1,0);return 0==e?NaN:d/e},a.sharpeRatioStatistics_=function(a,b){return c(a,b)},a.differentialReturns_=function(a,b){return d(a,b)},a.sharpeRatio=function(a,b){var d=c(a,b),e=d[0];return e},a.biasAdjustedSharpeRatio=function(a,b){var d=c(a,b),e=d[0],f=d[2];return e/f},a.doubleSharpeRatio=function(a,b){var d=c(a,b),e=d[0],f=Math.sqrt(d[1]);return e/f},a.sharpeRatioConfidenceInterval=function(a,b,d){var f=c(a,b),g=f[0],h=Math.sqrt(f[1]),i=e(1-d/2),j=g-i*h,k=g+i*h;return[j,k]},a.probabilisticSharpeRatio=function(a,b,d){var e=c(a,b),g=e[0],h=Math.sqrt(e[1]),i=(g-d)/h,j=f(i);return j},a.minimumTrackRecordLength=function(a,b,d,f){var g=c(a,b),h=g[0],i=g[1],j=e(1-d),k=1+i*(a.length-2)*(j/(h-f))*(j/(h-f));return k},a.cumulativeReturn=function(a){var b=NaN;return a.length>=2&&(b=(a[a.length-1]-a[0])/a[0]),b},a.cagr=function(a,b){function c(a){var b=new Date(a);return b.setMinutes(b.getMinutes()-b.getTimezoneOffset()),b}var d=a[0],e=b[0],f=a[a.length-1],g=b[b.length-1],h=864e5,i=(c(g)-c(e))/h,j=i/365.25,k=Math.pow(f/d,1/j)-1;return k},a.arithmeticReturns=function(a){var b=new a.constructor(a.length);b[0]=NaN;for(var c=1;c<a.length;++c)b[c]=(a[c]-a[c-1])/a[c-1];return b},a.valueAtRisk=function(b,c){var d=a.arithmeticReturns(b).slice(1);d.sort(function(a,b){return a-b});var e=1-c,f=Math.floor(e*d.length);if(0==f)return NaN;var g=-d[f-1];return g},a.norminv_=function(a,b){return e(a,b)},a.normcdf_=function(a){return f(a)},a.erf_=function(a){return g(a)},a.erfc_=function(a){return h(a)},a.hpm_=function(a,b,c){return j(a,b,c)},a.lpm_=function(a,b,c){return k(a,b,c)},a.mean_=function(a){return l(a)},a.variance_=function(a){return m(a)},a.covariance_=function(a,b){return o(a,b)},a.stddev_=function(a){return q(a)},a.sampleStddev_=function(a){return r(a)},a.sampleVariance_=function(a){return n(a)},a.sampleCovariance_=function(a,b){return p(a,b)},a.skewness_=function(a){return s(a)},a.sampleSkewness_=function(a){return t(a)},a.kurtosis_=function(a){return u(a)},a.sampleKurtosis_=function(a){return v(a)},a.sampleMoments_=function(a){return w(a)},a}(PortfolioAnalytics||{}),"undefined"!=typeof module&&(module.exports=PortfolioAnalytics);